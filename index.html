<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MyOrder Restaurant</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #fffaf0;
      color: #333;
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: #f8b400;
      padding: 10px 20px;
    }
    header img {
      height: 50px;
    }
    header button {
      padding: 10px;
      background-color: #fff;
      border: 2px solid #333;
      cursor: pointer;
    }
    #tabs {
      display: flex;
      gap: 10px;
      background-color: #f0f0f0;
      padding: 10px;
      flex-wrap: wrap;
    }
    .tab {
      padding: 10px;
      background-color: #fff;
      border: 1px solid #ccc;
      cursor: pointer;
    }
    .active {
      background-color: #f8b400;
      color: #fff;
    }
    .section {
      display: none;
      padding: 20px;
    }
    .visible {
      display: block;
    }
    .item {
      margin-bottom: 10px;
    }
    .item input {
      width: 50px;
    }
    #statusMessage {
      color: green;
      font-weight: bold;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <header>
    <img src="RLogo.jpg" alt="Restaurant Logo" />
    <button onclick="openLogin()">Operator login</button>
  </header>

  <div id="tabs">
    <div class="tab active" onclick="switchTab('drinks')">Dranken</div>
    <div class="tab" onclick="switchTab('fingerfood')">Fingerfood</div>
    <div class="tab" onclick="switchTab('desserts')">Dessert & Overige</div>
    <div class="tab" onclick="switchTab('menus')">Menu‚Äôs</div>
  </div>

  <div id="drinks" class="section visible">
    <div class="item">Cola flesje - ‚Ç¨0.10 <input type="number" min="0" value="0" id="cola" /></div>
    <div class="item">Water flesje - ‚Ç¨0.50 <input type="number" min="0" value="0" id="water" /></div>
  </div>
  <div id="fingerfood" class="section">
    <div class="item">Pringles Natural (‚Ç¨0.001 per chip, max 50): <input type="number" min="0" max="50" value="0" id="pringlesNatural" /></div>
    <div class="item">Pringles BBQ (‚Ç¨0.002 per chip, max 50): <input type="number" min="0" max="50" value="0" id="pringlesBBQ" /></div>
  </div>
  <div id="desserts" class="section">
    <p>Momenteel geen items.</p>
  </div>
  <div id="menus" class="section">
    <p>Momenteel geen items.</p>
  </div>

  <button onclick="placeOrder()">Bestellen</button>
  <div id="orderId"></div>
  <div id="orderStatus"></div>

  <div id="loginPanel" style="display:none">
    <h2>Operator login</h2>
    <input type="text" id="username" placeholder="Gebruikersnaam" />
    <input type="password" id="password" placeholder="Wachtwoord" />
    <button onclick="login()">Log in</button>
  </div>

  <div id="operatorPanel" style="display:none">
    <h2>Bestellingen (live)</h2>
    <div id="orders"></div>
  </div>

  <script>
    const binId = "688f6efe7b4b8670d8ac3f46";
    const apiKey = "$2a$10$XpZeyd.RhynC0Ie0VWma7uJPbMYdUAIHuG24Smc5V0C5LU5d11H5O";
    let currentOrderId = null;

    function switchTab(tabId) {
      document.querySelectorAll('.section').forEach(sec => sec.classList.remove('visible'));
      document.querySelector(`#${tabId}`).classList.add('visible');
      document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
      event.target.classList.add('active');
    }

    function openLogin() {
      document.getElementById('loginPanel').style.display = 'block';
    }

    function login() {
      const user = document.getElementById('username').value;
      const pass = document.getElementById('password').value;
      if (user === 'Operator' && pass === '8008') {
        document.getElementById('loginPanel').style.display = 'none';
        document.getElementById('operatorPanel').style.display = 'block';
        fetchOrders();
        setInterval(fetchOrders, 2000);
      }
    }

    function placeOrder() {
      const order = {
        id: Date.now(),
        cola: parseInt(document.getElementById('cola').value),
        water: parseInt(document.getElementById('water').value),
        pringlesNatural: parseInt(document.getElementById('pringlesNatural').value),
        pringlesBBQ: parseInt(document.getElementById('pringlesBBQ').value),
        status: 'In afwachting'
      };

      fetch(`https://api.jsonbin.io/v3/b/${binId}/latest`, {
        method: 'GET',
        headers: { 'X-Master-Key': apiKey }
      })
      .then(res => res.json())
      .then(data => {
        const orders = data.record || [];
        orders.push(order);
        fetch(`https://api.jsonbin.io/v3/b/${binId}`, {
          method: 'PUT',
          headers: {
            'Content-Type': 'application/json',
            'X-Master-Key': apiKey
          },
          body: JSON.stringify(orders)
        })
        .then(() => {
          currentOrderId = order.id;
          document.getElementById('orderId').innerText = `Bestelnummer: ${order.id}`;
          setInterval(() => checkStatus(order.id), 2000);
        });
      });
    }

    function checkStatus(id) {
      fetch(`https://api.jsonbin.io/v3/b/${binId}/latest`, {
        headers: { 'X-Master-Key': apiKey }
      })
      .then(res => res.json())
      .then(data => {
        const order = data.record.find(o => o.id === id);
        if (order) {
          document.getElementById('orderStatus').innerText = `Status: ${order.status}`;
          if (order.status === 'Klaar') alert('üéâ Je bestelling is klaar!');
        }
      });
    }

    function fetchOrders() {
      fetch(`https://api.jsonbin.io/v3/b/${binId}/latest`, {
        headers: { 'X-Master-Key': apiKey }
      })
      .then(res => res.json())
      .then(data => {
        const ordersDiv = document.getElementById('orders');
        ordersDiv.innerHTML = '';
        (data.record || []).forEach(order => {
          const div = document.createElement('div');
          div.innerHTML = `
            <strong>Bestelnummer:</strong> ${order.id}<br>
            Cola: ${order.cola}, Water: ${order.water}<br>
            Pringles Natural: ${order.pringlesNatural}, BBQ: ${order.pringlesBBQ}<br>
            <strong>Status:</strong> ${order.status}<br>
            <button onclick="updateStatus(${order.id}, 'In bereiding')">In bereiding</button>
            <button onclick="updateStatus(${order.id}, 'Klaar')">Klaar</button>
            <button onclick="deleteOrder(${order.id})">üóëÔ∏è Verwijder</button>
            <hr>
          `;
          ordersDiv.appendChild(div);
        });
      });
    }

    function updateStatus(id, status) {
      fetch(`https://api.jsonbin.io/v3/b/${binId}/latest`, {
        headers: { 'X-Master-Key': apiKey }
      })
      .then(res => res.json())
      .then(data => {
        const orders = data.record.map(o => {
          if (o.id === id) o.status = status;
          return o;
        });
        return fetch(`https://api.jsonbin.io/v3/b/${binId}`, {
          method: 'PUT',
          headers: {
            'Content-Type': 'application/json',
            'X-Master-Key': apiKey
          },
          body: JSON.stringify(orders)
        });
      });
    }

    function deleteOrder(id) {
      fetch(`https://api.jsonbin.io/v3/b/${binId}/latest`, {
        headers: { 'X-Master-Key': apiKey }
      })
      .then(res => res.json())
      .then(data => {
        const newOrders = data.record.filter(o => o.id !== id);
        return fetch(`https://api.jsonbin.io/v3/b/${binId}`, {
          method: 'PUT',
          headers: {
            'Content-Type': 'application/json',
            'X-Master-Key': apiKey
          },
          body: JSON.stringify(newOrders)
        });
      });
    }
  </script>
</body>
</html>
