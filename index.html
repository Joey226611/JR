<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <title>MyOrder – Restaurant</title>
  <style>
    body { font-family: serif; background: #f6f1e1; color: #333; margin: 20px; }
    header { text-align: center; margin-bottom: 20px; }
    nav button { margin: 0 5px; padding: 10px 15px; cursor: pointer; }
    section { display: none; }
    section.active { display: block; }
    .item { margin-bottom: 10px; }
    .order-summary { border-top: 1px solid #aaa; margin-top: 20px; padding-top: 10px; }
    .login { margin-bottom: 20px; }
  </style>
</head>
<body>
  <header>
    <img src="RLogo.png" alt="Logo" width="150"
         onerror="this.onerror=null; this.src='RLogo.jpeg';" />
    <h1>Welkom bij MyOrder</h1>
    <button id="start-btn">START</button>
  </header>

  <div id="venue" style="display:none;">
    <div class="login">
      <label>Username: <input id="username"></label>
      <label>Password: <input id="password" type="password"></label>
      <button id="login-btn">Inloggen</button>
      <span id="login-status"></span>
    </div>
    <nav>
      <button data-tab="dranken">Dranken</button>
      <button data-tab="fingerfood">Fingerfood</button>
      <button data-tab="desserts">Dessert & Overige</button>
      <button data-tab="menus">Menu’s</button>
    </nav>

    <section id="dranken">
      <h2>Dranken</h2>
      <div class="item">
        <span>Cola (€0.10 per stuk)</span>
        <input type="number" min="0" max="100" value="0" data-price="0.10">
      </div>
      <div class="item">
        <span>Water (€0.50 per stuk, met kans op gratis glas!)</span>
        <input type="number" min="0" max="100" value="0" data-price="0.50">
      </div>
    </section>

    <section id="fingerfood">
      <h2>Fingerfood</h2>
      <div class="item">
        <span>Pringles Natural (€0.001 per chip → €0.10 per 100 chips)</span>
        <input type="number" min="0" max="50" value="0" data-price="0.001">
      </div>
      <div class="item">
        <span>Pringles BBQ Saus (€0.002 per chip)</span>
        <input type="number" min="0" max="50" value="0" data-price="0.002">
      </div>
    </section>

    <section id="desserts">
      <h2>Dessert & Overige</h2>
      <p>Geen items beschikbaar momenteel.</p>
    </section>
    <section id="menus">
      <h2>Menu’s</h2>
      <p>Geen items beschikbaar momenteel.</p>
    </section>

    <button id="bestel-btn">Bestellen</button>
    <div id="order-summary" class="order-summary"></div>

    <div id="operator-panel" style="display:none;">
      <h2>Operator paneel — Bestellingen</h2>
      <ul id="orders-list"></ul>
    </div>
  </div>

<script>
  const startBtn = document.getElementById('start-btn');
  const venue = document.getElementById('venue');
  startBtn.onclick = () => { venue.style.display = 'block'; startBtn.style.display = 'none'; };

  document.querySelectorAll('nav button').forEach(btn => {
    btn.addEventListener('click', () => {
      document.querySelectorAll('section').forEach(sec => sec.classList.remove('active'));
      document.getElementById(btn.dataset.tab).classList.add('active');
    });
  });

  // show default tab
  document.querySelector('nav button[data-tab="dranken"]').click();

  let orders = [];
  let nextOrderId = 1;
  let loggedIn = false;

  document.getElementById('bestel-btn').onclick = () => {
    const items = [];
    let total = 0;
    document.querySelectorAll('section.active .item input').forEach(inp => {
      const qty = parseInt(inp.value) || 0;
      const price = parseFloat(inp.dataset.price);
      if (qty > 0) {
        items.push({ name: inp.previousSibling.textContent.trim(), qty, price });
        total += qty * price;
      }
    });
    if (items.length === 0) {
      alert('Kies minstens één item.');
      return;
    }
    const order = { id: nextOrderId++, items, total: total.toFixed(2), status: 'nieuw' };
    orders.push(order);
    showSummary(order);
  };

  function showSummary(order) {
    const div = document.getElementById('order-summary');
    let html = '<h3>Bestelling #'+order.id+'</h3><ul>';
    order.items.forEach(it => {
      html += `<li>${it.name}: ${it.qty} × €${it.price.toFixed(3)} = €${(it.qty*it.price).toFixed(2)}</li>`;
    });
    html += `</ul><strong>Totaal: €${order.total}</strong>`;
    div.innerHTML = html;
    if (loggedIn) updateOperatorPanel();
  }

  document.getElementById('login-btn').onclick = () => {
    const u = document.getElementById('username').value;
    const p = document.getElementById('password').value;
    if (u==='Operator' && p==='8008') {
      loggedIn = true;
      document.getElementById('login-status').textContent = 'Ingelogd als Operator';
      document.getElementById('operator-panel').style.display = 'block';
      updateOperatorPanel();
    } else {
      alert('Verkeerde inloggegevens');
    }
  };

  function updateOperatorPanel() {
    const ul = document.getElementById('orders-list');
    ul.innerHTML = '';
    orders.forEach(o => {
      const li = document.createElement('li');
      li.innerHTML = `#${o.id} – €${o.total} – status: ${o.status}
        <button data-id="${o.id}" data-status="bereiding">In bereiding</button>
        <button data-id="${o.id}" data-status="klaar">Klaar</button>`;
      ul.appendChild(li);
    });
    ul.querySelectorAll('button').forEach(btn => {
      btn.onclick = () => {
        const id = parseInt(btn.dataset.id);
        const st = btn.dataset.status;
        const ord = orders.find(x => x.id === id);
        ord.status = st;
        updateOperatorPanel();
        if (!loggedIn) return;
        if (lastSummaryOrder && lastSummaryOrder.id === id) {
          showSummary(ord);
        }
      };
    });
  }

  let lastSummaryOrder = null;
  function showSummary(order){
    lastSummaryOrder = order;
    const div = document.getElementById('order-summary');
    let html = '<h3>Bestelling #'+order.id+'</h3>';
    html += `<p>Status: ${order.status}</p><ul>`;
    order.items.forEach(it => {
      html += `<li>${it.name}: ${it.qty} × €${it.price.toFixed(3)} = €${(it.qty*it.price).toFixed(2)}</li>`;
    });
    html += `</ul><strong>Totaal: €${order.total}</strong>`;
    div.innerHTML = html;
  }
</script>
</body>
</html>
