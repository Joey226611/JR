<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Restaurant Bestelsysteem</title>
  <style>
    /* Basis styling */
    body {
      font-family: Arial, sans-serif;
      margin: 0; padding: 0;
      background: #fafafa;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
    header {
      background: #333;
      color: white;
      padding: 15px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    header h1 {
      margin: 0;
      font-weight: normal;
      font-size: 1.5rem;
    }
    main {
      flex-grow: 1;
      padding: 20px;
    }
    /* Tabs */
    #tabs {
      display: flex;
      gap: 15px;
      margin-bottom: 20px;
    }
    #tabs button {
      background: #ddd;
      border: none;
      padding: 10px 20px;
      cursor: pointer;
      border-radius: 5px 5px 0 0;
      font-weight: bold;
      transition: background 0.3s;
    }
    #tabs button.active {
      background: #333;
      color: white;
    }
    /* Tab content */
    .tab-content {
      display: none;
      background: white;
      padding: 15px;
      border: 1px solid #ccc;
      border-top: none;
      border-radius: 0 5px 5px 5px;
      min-height: 200px;
    }
    .tab-content.active {
      display: block;
    }
    /* Menu item styling */
    .menu-item {
      border-bottom: 1px solid #eee;
      padding: 10px 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .menu-item button {
      background: #4CAF50;
      border: none;
      color: white;
      padding: 6px 12px;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .menu-item button:hover {
      background: #45a049;
    }
    /* Winkelmandje knop */
    #cartBtn {
      position: fixed;
      right: 20px;
      bottom: 20px;
      background: #e91e63;
      border: none;
      color: white;
      padding: 15px 20px;
      font-weight: bold;
      border-radius: 50px;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
      display: flex;
      align-items: center;
      gap: 10px;
      z-index: 1000;
    }
    #cartCount {
      background: white;
      color: #e91e63;
      border-radius: 50%;
      padding: 2px 7px;
      font-weight: bold;
      font-size: 0.9rem;
      min-width: 24px;
      text-align: center;
    }
    /* Modal styling */
    .modal {
      position: fixed;
      top:0; left:0; right:0; bottom:0;
      background: rgba(0,0,0,0.5);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 2000;
    }
    .modal.active {
      display: flex;
    }
    .modal-content {
      background: white;
      padding: 25px;
      border-radius: 10px;
      max-width: 400px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: 0 10px 25px rgba(0,0,0,0.2);
    }
    .modal-content h2, .modal-content h3 {
      margin-top: 0;
    }
    .modal-footer {
      margin-top: 15px;
      text-align: right;
    }
    .modal-footer .btn {
      margin-left: 10px;
    }
    .btn {
      padding: 8px 16px;
      border: none;
      background: #4CAF50;
      color: white;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      transition: background 0.3s;
    }
    .btn:hover {
      background: #45a049;
    }
    .btn.cancel {
      background: #f44336;
    }
    .btn.cancel:hover {
      background: #d32f2f;
    }
    /* Operator orders */
    #operatorOrders .order-item {
      border-bottom: 1px solid #ccc;
      padding: 8px 0;
      cursor: pointer;
    }
    #operatorOrders .order-item:hover {
      background: #f0f0f0;
    }
    /* Screen view */
    #screenView {
      display: none;
      flex-direction: row;
      justify-content: space-around;
      padding: 20px;
      gap: 40px;
      flex-wrap: wrap;
      background: #222;
      color: white;
      min-height: 80vh;
    }
    #screenView > div {
      flex: 1 1 40%;
      background: #333;
      border-radius: 10px;
      padding: 15px;
      min-width: 250px;
      max-height: 70vh;
      overflow-y: auto;
    }
    #screenView h3 {
      margin-top: 0;
      border-bottom: 2px solid #aaa;
      padding-bottom: 10px;
    }
    .order-item-screen {
      font-size: 2rem;
      font-weight: bold;
      margin-bottom: 10px;
      border-radius: 5px;
      padding: 10px;
      color: white;
    }
    .order-pending {
      background: #a0522d; /* bruin */
      text-align: left;
    }
    .order-ready {
      background: #2e8b57; /* groen */
      text-align: right;
    }
    /* Login pages styling */
    #loginPages {
      display: none;
      min-height: 80vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .login-page {
      background: white;
      padding: 30px 40px;
      border-radius: 12px;
      box-shadow: 0 10px 20px rgba(0,0,0,0.3);
      width: 320px;
    }
    .login-page h2 {
      margin-top: 0;
      margin-bottom: 20px;
      text-align: center;
    }
    .login-page label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }
    .login-page input {
      width: 100%;
      padding: 8px 10px;
      margin-bottom: 15px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 1rem;
    }
    .login-page button {
      width: 100%;
      font-size: 1rem;
    }
    /* Responsive */
    @media(max-width: 700px) {
      #screenView {
        flex-direction: column;
      }
      #screenView > div {
        max-width: 100%;
      }
      #tabs {
        flex-wrap: wrap;
      }
    }
  </style>
</head>
<body>

<header>
  <h1>RLogo Restaurant</h1>
  <nav>
    <a href="#/" style="color:white; text-decoration:none; font-weight:bold; margin-right: 15px;">Bestellen</a>
    <a href="#/operatorlogin" style="color:white; text-decoration:none; font-weight:bold; margin-right: 15px;">Operator Login</a>
    <a href="#/screenlogin" style="color:white; text-decoration:none; font-weight:bold;">Scherm Login</a>
  </nav>
</header>

<!-- Main bestel systeem -->
<main id="mainView">
  <div id="tabs">
    <button class="active" data-tab="drinksTab">Dranken</button>
    <button data-tab="fingerfoodTab">Fingerfood</button>
    <button data-tab="dessertsTab">Desserts</button>
    <button data-tab="menusTab">Menu's</button>
  </div>

  <section id="drinksTab" class="tab-content active">
    <div class="menu-item" data-name="Cola" data-price="1.50">
      <div>Cola - â‚¬1.50</div>
      <button onclick="addToCart(event)">Voeg toe</button>
    </div>
    <div class="menu-item" data-name="Water" data-price="1.00">
      <div>Water - â‚¬1.00</div>
      <button onclick="addToCart(event)">Voeg toe</button>
    </div>
  </section>

  <section id="fingerfoodTab" class="tab-content">
    <div class="menu-item" data-name="Pringles Natural" data-price="0.10">
      <div>Pringles Natural - â‚¬0.10 per chip</div>
      <button onclick="openAmountPopup(event)">Aantal kiezen</button>
    </div>
    <div class="menu-item" data-name="Pringles BBQ-saus" data-price="0.12">
      <div>Pringles BBQ-saus - â‚¬0.12 per chip</div>
      <button onclick="openAmountPopup(event)">Aantal kiezen</button>
    </div>
  </section>

  <section id="dessertsTab" class="tab-content">
    <div class="menu-item" data-name="Chocolade Taart" data-price="2.50">
      <div>Chocolade Taart - â‚¬2.50</div>
      <button onclick="addToCart(event)">Voeg toe</button>
    </div>
    <div class="menu-item" data-name="Vanille Ijs" data-price="2.00">
      <div>Vanille Ijs - â‚¬2.00</div>
      <button onclick="addToCart(event)">Voeg toe</button>
    </div>
  </section>

  <section id="menusTab" class="tab-content">
    <div class="menu-item" data-name="Menu Kinder" data-price="5.00">
      <div>Menu Kinder - â‚¬5.00</div>
      <button onclick="addToCart(event)">Voeg toe</button>
    </div>
    <div class="menu-item" data-name="Menu Volwassen" data-price="9.00">
      <div>Menu Volwassen - â‚¬9.00</div>
      <button onclick="addToCart(event)">Voeg toe</button>
    </div>
  </section>
</main>

<!-- Winkelmandje knop -->
<button id="cartBtn" aria-label="Winkelmandje">
  ðŸ›’ <span id="cartCount">0</span>
</button>

<!-- Modals -->

<!-- Aantal chips modal -->
<div class="modal" id="amountModal">
  <div class="modal-content">
    <h2>Kies aantal chips</h2>
    <input type="number" id="amountInput" min="1" max="50" value="1" />
    <div class="modal-footer">
      <button class="btn" onclick="confirmAmount()">Bevestigen</button>
      <button class="btn cancel" onclick="closeAmountPopup()">Annuleren</button>
    </div>
  </div>
</div>

<!-- Winkelmandje modal -->
<div class="modal" id="cartModal">
  <div class="modal-content">
    <h2>Winkelmandje</h2>
    <div id="cartItems">Winkelmandje is leeg.</div>
    <label for="orderNotes">Opmerkingen / AllergieÃ«n (optioneel):</label>
    <textarea id="orderNotes" placeholder="Bijv. Geen pinda's..."></textarea>
    <div class="modal-footer">
      <button class="btn" onclick="placeOrder()">Bestelling plaatsen</button>
      <button class="btn cancel" onclick="closeCart()">Sluiten</button>
    </div>
  </div>
</div>

<!-- Bestelling geplaatst scherm -->
<div class="modal" id="keepOpenScreen">
  <div class="modal-content" style="text-align:center;">
    <p>Uw bestelling is geplaatst! Uw bestelnummer is:</p>
    <div id="orderNumberDisplay">#0</div>
    <p>Laat deze website open totdat uw bestelling klaar is.</p>
    <button class="btn" onclick="closeKeepOpen()">Sluiten</button>
  </div>
</div>

<!-- Operator view -->
<div id="operatorView" style="display:none; padding: 20px;">
  <h2>Operator Bestellingen</h2>
  <div id="operatorOrders">Geen bestellingen.</div>
  <div class="modal-footer" style="margin-top:20px;">
    <button class="btn cancel" onclick="logoutOperator()" id="operatorLogoutBtn">Uitloggen</button>
  </div>
</div>

<!-- Order detail modal -->
<div class="modal" id="orderDetailModal">
  <div class="modal-content">
    <h3>Bestelling Details</h3>
    <div id="orderDetailContent"></div>
    <label for="orderStatusSelect">Status:</label>
    <select id="orderStatusSelect">
      <option value="pending">In Behandeling</option>
      <option value="ready">Klaar</option>
      <option value="delayed">Kan langer duren</option>
    </select>
    <label for="extraText">Extra tekst (communicatie):</label>
    <textarea id="extraText" placeholder="Voeg hier een tekst toe..."></textarea>
    <div class="modal-footer">
      <button class="btn" onclick="updateOrder()">Opslaan</button>
      <button class="btn cancel" onclick="deleteOrder()">Verwijderen</button>
      <button class="btn cancel" onclick="closeOrderDetail()">Sluiten</button>
    </div>
  </div>
</div>

<!-- Scherm account login pagina -->
<div id="loginPages" style="display:none; flex-direction: column; align-items: center;">
  <div id="operatorLoginPage" class="login-page" style="display:none;">
    <h2>Operator Login</h2>
    <label for="loginUser">Gebruikersnaam:</label>
    <input type="text" id="loginUser" autocomplete="username" />
    <label for="loginPass">Wachtwoord:</label>
    <input type="password" id="loginPass" autocomplete="current-password" />
    <button class="btn" onclick="operatorLogin()">Inloggen</button>
  </div>
  <div id="screenLoginPage" class="login-page" style="display:none; margin-top: 40px;">
    <h2>Scherm Account Login</h2>
    <label for="screenUser">Gebruikersnaam:</label>
    <input type="text" id="screenUser" autocomplete="username" />
    <label for="screenPass">Wachtwoord:</label>
    <input type="password" id="screenPass" autocomplete="current-password" />
    <button class="btn" onclick="screenLogin()">Inloggen</button>
  </div>
  <button class="btn cancel" style="margin-top:40px;" onclick="backToMain()">Terug naar Bestellen</button>
</div>

<!-- Scherm account view -->
<div id="screenView" style="display:none; flex-direction: row; justify-content: space-around; padding: 20px; gap: 40px; flex-wrap: wrap; background: #222; color: white; min-height: 80vh;">
  <div>
    <h3>In Behandeling</h3>
    <div id="screenPendingOrders">Laden...</div>
  </div>
  <div>
    <h3>Klaar</h3>
    <div id="screenReadyOrders">Laden...</div>
  </div>
  <button class="btn cancel" style="margin-top:15px;" onclick="screenLogout()" id="screenLogoutBtn">Uitloggen Scherm</button>
</div>

<audio id="doneSound" src="Sounds/DoneSoundForScreen.mp3" preload="auto"></audio>

<script>
(() => {
  const BIN_ID = '688f6efe7b4b8670d8ac3f46';
  const API_KEY = '$2a$10$XpZeyd.RhynC0Ie0VWma7uJPbMYdUAIHuG24Smc5V0C5LU5d11H5O';

  let ordersData = { counter: 0, orders: [] };

  let cart = [];
  let currentAmountItem = null;
  let editingOrder = null;
  let loggedInOperator = false;
  let loggedInScreen = false;
  let language = 'en';

  // DOM elementen
  const tabs = document.querySelectorAll('#tabs button');
  const cartBtn = document.getElementById('cartBtn');
  const cartCount = document.getElementById('cartCount');
  const cartModal = document.getElementById('cartModal');
  const cartItemsDiv = document.getElementById('cartItems');
  const amountModal = document.getElementById('amountModal');
  const amountInput = document.getElementById('amountInput');
  const keepOpenScreen = document.getElementById('keepOpenScreen');
  const orderNumberDisplay = document.getElementById('orderNumberDisplay');
  const orderNotes = document.getElementById('orderNotes');

  const loginPages = document.getElementById('loginPages');
  const operatorLoginPage = document.getElementById('operatorLoginPage');
  const screenLoginPage = document.getElementById('screenLoginPage');

  const mainView = document.getElementById('mainView');
  const operatorView = document.getElementById('operatorView');
  const operatorOrdersDiv = document.getElementById('operatorOrders');
  const orderDetailModal = document.getElementById('orderDetailModal');
  const orderDetailContent = document.getElementById('orderDetailContent');
  const orderStatusSelect = document.getElementById('orderStatusSelect');
  const extraTextInput = document.getElementById('extraText');

  const screenView = document.getElementById('screenView');
  const screenPendingOrdersDiv = document.getElementById('screenPendingOrders');
  const screenReadyOrdersDiv = document.getElementById('screenReadyOrders');

  const doneSound = document.getElementById('doneSound');

  // Helpers

  function showView(viewName) {
    // Verberg alles eerst
    mainView.style.display = 'none';
    operatorView.style.display = 'none';
    loginPages.style.display = 'none';
    screenView.style.display = 'none';

    // Toon wat nodig is
    if (viewName === 'main') {
      mainView.style.display = 'block';
      cartBtn.style.display = 'flex';
    } else if (viewName === 'operatorLogin') {
      loginPages.style.display = 'flex';
      operatorLoginPage.style.display = 'block';
      screenLoginPage.style.display = 'none';
      cartBtn.style.display = 'none';
    } else if (viewName === 'screenLogin') {
      loginPages.style.display = 'flex';
      operatorLoginPage.style.display = 'none';
      screenLoginPage.style.display = 'block';
      cartBtn.style.display = 'none';
    } else if (viewName === 'operatorView') {
      operatorView.style.display = 'block';
      cartBtn.style.display = 'none';
    } else if (viewName === 'screenView') {
      screenView.style.display = 'flex';
      cartBtn.style.display = 'none';
    }
  }

  // Hash-based routing

  function handleRoute() {
    const hash = location.hash || '#/';
    if (hash === '#/' || hash === '#') {
      // hoofd bestel scherm
      showView('main');
    } else if (hash === '#/operatorlogin') {
      showView('operatorLogin');
    } else if (hash === '#/operatorview') {
      if (loggedInOperator) {
        showView('operatorView');
      } else {
        location.hash = '#/operatorlogin';
      }
    } else if (hash === '#/screenlogin') {
      showView('screenLogin');
    } else if (hash === '#/screenview') {
      if (loggedInScreen) {
        showView('screenView');
      } else {
        location.hash = '#/screenlogin';
      }
    } else {
      // onbekende route â†’ fallback naar hoofd
      location.hash = '#/';
    }
  }
  window.addEventListener('hashchange', handleRoute);

  // Tabs switching
  tabs.forEach(btn => {
    btn.addEventListener('click', () => {
      tabs.forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      document.querySelectorAll('.tab-content').forEach(tc => tc.classList.remove('active'));
      const target = btn.dataset.tab;
      document.getElementById(target).classList.add('active');
    });
  });

  // Cart logic
  function addToCart(event) {
    const itemDiv = event.target.closest('.menu-item');
    const name = itemDiv.dataset.name;
    const price = parseFloat(itemDiv.dataset.price);
    if (name.toLowerCase().includes('pringles')) {
      openAmountPopup(event);
      return;
    }
    // check if already in cart: +1
    const found = cart.find(i => i.name === name);
    if (found) {
      found.amount++;
    } else {
      cart.push({name, price, amount:1});
    }
    updateCartCount();
  }

  // Amount popup for pringles
  function openAmountPopup(event) {
    currentAmountItem = event.target.closest('.menu-item');
    amountInput.value = 1;
    amountModal.classList.add('active');
  }
  function closeAmountPopup() {
    currentAmountItem = null;
    amountModal.classList.remove('active');
  }
  function confirmAmount() {
    const amount = parseInt(amountInput.value);
    if (isNaN(amount) || amount < 1 || amount > 50) {
      alert('Voer een getal in tussen 1 en 50.');
      return;
    }
    const name = currentAmountItem.dataset.name;
    const price = parseFloat(currentAmountItem.dataset.price);
    const found = cart.find(i => i.name === name);
    if (found) {
      found.amount += amount;
    } else {
      cart.push({name, price, amount});
    }
    updateCartCount();
    closeAmountPopup();
  }

  // Update cart count display
  function updateCartCount() {
    let total = 0;
    cart.forEach(i => total += i.amount);
    cartCount.textContent = total;
  }

  // Open/close cart modal
  cartBtn.addEventListener('click', () => {
    renderCartItems();
    cartModal.classList.add('active');
  });
  function closeCart() {
    cartModal.classList.remove('active');
  }

  // Render cart items
  function renderCartItems() {
    if(cart.length === 0) {
      cartItemsDiv.textContent = 'Winkelmandje is leeg.';
      return;
    }
    cartItemsDiv.innerHTML = '';
    cart.forEach((item, i) => {
      const div = document.createElement('div');
      div.textContent = `${item.name} x${item.amount} - â‚¬${(item.price * item.amount).toFixed(2)}`;
      cartItemsDiv.appendChild(div);
    });
  }

  // Place order (met opmerkingen)
  async function placeOrder() {
    if(cart.length === 0) {
      alert('Winkelmandje is leeg!');
      return;
    }
    const notes = orderNotes.value.trim();

    ordersData.counter = parseInt(ordersData.counter) || 0;
    ordersData.counter++;
    const orderNumber = ordersData.counter;

    const newOrder = {
      number: orderNumber,
      items: [...cart],
      status: 'pending',
      extraText: '',
      notes,
      created: new Date().toISOString()
    };
    ordersData.orders.push(newOrder);
    await saveOrdersData();

    // reset
    cart = [];
    updateCartCount();
    orderNotes.value = '';
    closeCart();

    // Show keep open screen met ordernummer
    orderNumberDisplay.textContent = `#${orderNumber}`;
    keepOpenScreen.classList.add('active');

    // Force update operator en screen
    if(loggedInOperator) renderOperatorOrders();
    if(loggedInScreen) renderScreenOrders();
  }

  function closeKeepOpen() {
    keepOpenScreen.classList.remove('active');
    // Terug naar hoofd bestel scherm
    location.hash = '#/';
  }

  // Operator login
  async function operatorLogin() {
    const user = document.getElementById('loginUser').value.trim();
    const pass = document.getElementById('loginPass').value.trim();

    if(user === 'Operator' && pass === '8008') {
      loggedInOperator = true;
      location.hash = '#/operatorview';
      loadOrdersData();
      renderOperatorOrders();
    } else {
      alert('Verkeerde inloggegevens.');
    }
  }
  function logoutOperator() {
    loggedInOperator = false;
    location.hash = '#/';
  }

  // Screen login
  async function screenLogin() {
    const user = document.getElementById('screenUser').value.trim();
    const pass = document.getElementById('screenPass').value.trim();

    if(user === 'OperatorScreen' && pass === '8008') {
      loggedInScreen = true;
      location.hash = '#/screenview';
      loadOrdersData();
      renderScreenOrders();
    } else {
      alert('Verkeerde inloggegevens.');
    }
  }
  function screenLogout() {
    loggedInScreen = false;
    location.hash = '#/';
  }

  // Load and save data bij API JSONBin
  async function loadOrdersData() {
    try {
      const res = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`, {
        headers: {
          'X-Master-Key': API_KEY
        }
      });
      const json = await res.json();
      if(json.record) {
        ordersData = json.record;
        ordersData.counter = parseInt(ordersData.counter) || 0;
        if(!ordersData.orders) ordersData.orders = [];
      } else {
        ordersData = { counter: 0, orders: [] };
      }
    } catch(e) {
      console.warn('Kon niet data laden, gebruik cache.');
    }
  }
  async function saveOrdersData() {
    try {
      await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}`, {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json',
          'X-Master-Key': API_KEY
        },
        body: JSON.stringify(ordersData)
      });
    } catch(e) {
      alert('Fout bij opslaan, probeer opnieuw.');
    }
  }

  // Render operator orders
  function renderOperatorOrders() {
    if(!loggedInOperator) return;
    operatorOrdersDiv.innerHTML = '';
    if(ordersData.orders.length === 0) {
      operatorOrdersDiv.textContent = 'Geen bestellingen.';
      return;
    }
    ordersData.orders.forEach(order => {
      const div = document.createElement('div');
      div.className = 'order-item';
      div.textContent = `#${order.number} - ${new Date(order.created).toLocaleString()} - Status: ${statusText(order.status)}`;
      div.onclick = () => openOrderDetail(order.number);
      operatorOrdersDiv.appendChild(div);
    });
  }
  // Open order detail modal
  function openOrderDetail(orderNumber) {
    editingOrder = ordersData.orders.find(o => o.number === orderNumber);
    if(!editingOrder) return alert('Bestelling niet gevonden.');

    orderDetailContent.textContent = editingOrder.items.map(i => `${i.name} x${i.amount} - â‚¬${(i.price*i.amount).toFixed(2)}`).join('\n');
    orderStatusSelect.value = editingOrder.status;
    extraTextInput.value = editingOrder.extraText || '';
    orderDetailModal.classList.add('active');
  }
  // Close order detail
  function closeOrderDetail() {
    orderDetailModal.classList.remove('active');
    editingOrder = null;
  }
  // Update order (status en extra tekst)
  async function updateOrder() {
    if(!editingOrder) return;
    editingOrder.status = orderStatusSelect.value;
    editingOrder.extraText = extraTextInput.value.trim();
    await saveOrdersData();
    renderOperatorOrders();
    renderScreenOrders();
    closeOrderDetail();
  }
  // Delete order
  async function deleteOrder() {
    if(!editingOrder) return;
    if(!confirm(`Weet je zeker dat je bestelling #${editingOrder.number} wilt verwijderen?`)) return;
    ordersData.orders = ordersData.orders.filter(o => o.number !== editingOrder.number);
    await saveOrdersData();
    renderOperatorOrders();
    renderScreenOrders();
    closeOrderDetail();
  }

  // Render screen orders
  function renderScreenOrders() {
    if(!loggedInScreen) return;
    screenPendingOrdersDiv.innerHTML = '';
    screenReadyOrdersDiv.innerHTML = '';

    const pendingOrders = ordersData.orders.filter(o => o.status === 'pending');
    const readyOrders = ordersData.orders.filter(o => o.status === 'ready');

    pendingOrders.forEach(o => {
      const div = document.createElement('div');
      div.className = 'order-item-screen order-pending';
      div.textContent = `#${o.number}`;
      screenPendingOrdersDiv.appendChild(div);
    });
    readyOrders.forEach(o => {
      const div = document.createElement('div');
      div.className = 'order-item-screen order-ready';
      div.textContent = `#${o.number}`;
      screenReadyOrdersDiv.appendChild(div);
    });

    // Speel sound af als er nieuwe klaar komen
    if(readyOrders.length > 0 && !doneSound.played) {
      doneSound.play().catch(() => {});
      doneSound.played = true;
    } else if(readyOrders.length === 0) {
      doneSound.played = false;
    }
  }

  // Poll alle 5 seconden de data
  setInterval(async () => {
    await loadOrdersData();
    if(loggedInOperator) renderOperatorOrders();
    if(loggedInScreen) renderScreenOrders();
  }, 5000);

  // Status vertaling
  function statusText(status) {
    if(status === 'pending') return 'In Behandeling';
    if(status === 'ready') return 'Klaar';
    if(status === 'delayed') return 'Kan langer duren';
    return status;
  }

  // Terug naar hoofd bestel scherm vanuit login
  function backToMain() {
    location.hash = '#/';
  }

  // Init routing
  handleRoute();

})();
</script>

</body>
</html>
